.row-fluid
  %ul#dashboardTab.nav.nav-pills.nav-background
    %li.active
      %a{"data-toggle" => "pill", :href => "#dashboard"} Dashboard
    %li
      %a{"data-toggle" => "pill", :href => "#groups"} Groups
    %li
      %a{"data-toggle" => "pill", :href => "#platforms"} Platforms
    %li
      %a{"data-toggle" => "pill", :href => "#processing"} Process Sensors
  .tab-content
    #dashboard.tab-pane.active
      .row-fluid
        .span12
          %h4 System Messages
          #resque
            =render "status/system_status"
      %hr/
      .row-fluid
        .sensor-controls
          = button_to 'Remove All Failed Jobs', resques_path, method: :delete, class: "btn btn-primary"
        %h4 Processing Errors
      .row-fluid
        .span12
          %table.table.table-striped.table-condensed
            %tr
              %th{:width => "300"} Error Message
              %th{:width => "180"}
              %th{:width => "180"}
            - @failures.each_with_index do |f, index|
              %tr
                %td
                  = f["error"]
                %td
                  = button_to 'Requeue', retry_resque_path(index), class: "btn btn-primary"
                %td
                  = button_to 'Remove', resque_path(index), method: :delete, class: "btn btn-danger"
    #groups.tab-pane
      .sensor-controls
        = link_to 'New Group', new_group_path, class: "btn btn-primary"
      %h3 Group List
      %br/
      %table.table.table-striped.table-condensed
        %tr
          %th{:width => "200"} Group Name
          %th{:width => "200"} Description
          %th{:width => "400"} Controls
          = render @group
    #platforms.tab-pane
      .sensor-controls
        = link_to 'New Platform', new_platform_path, class: "btn btn-primary"
      %h3 Platform List
      %br/
      %table.table.table-striped.table-condensed
        %tr
          %th{:width => "200"} Platform Name
          %th{:width => "200"} Geographic Location
          %th{:width => "200"} Agency
          %th{:width => "200"} Controls
          = render @platform
    #processing.tab-pane
      .sensor-controls
        = link_to 'New Process', new_group_event_path(@group), class: "btn btn-primary"
      %h3 Process Event List
      %br/
      = paginate @events, :param_name => "event_page"
      %table.table.table-striped.table-condensed
        %tr
          %th{:width => "200"} Processed Field
          %th{:width => "200"} Raw Data Fields
          %th{:width => "500"} Description
          %th{:widht => "160"}
          %th{:widht => "160"}
        = render @events, :locals => { :group => @group }

:javascript
  (function poll(){
  setTimeout(function(){
    $('#resque').load("#{poll_status_path}", poll);
    }, 5000 );
    })();

  $('#dashboardTab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });
  #{raw show_tab_for("dashboardTab")}
