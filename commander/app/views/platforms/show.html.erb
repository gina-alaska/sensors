<div class="sensor-controls">
  <%= link_to 'Edit', edit_platform_path(@platform), class: "btn btn-primary" %> 
  <%= link_to 'Back', platforms_path, class: "btn btn-primary" %>
</div>
<h2>Operations for the <%= @platform.name %> Platform</h2>
<hr>
<table>
  <tr>
    <td width="160"><b>Name:</b></td><td width="200"><%= @platform.name %></td>
    <td width="160"><b>Slug:</b></td><td width="200"><%= @platform.slug %></td>
  </tr>
  <tr>
    <td><b>Agency:</td><td><%= @platform.agency %></td>
    <td><b>Authority:</b></td><td><%= @platform.authority %></td>
  </tr>
  <tr>
    <td><b>License:</b></td><td><%= @platform.license %></td>
    <td><b>Permissions:</b></td><td><%= @platform.permissions %></td>
  </tr>
  <tr>
    <td><b>No Data Value:</b></td><td><%= @platform.no_data_value %></td>
    <td><b>Graph View Length:</b></td><td><%= @platform.graph_length %></td>
  </tr>
  <tr>
    <td><b>Platform Metadata:</b></td>
    <td colspan="3"><%= @platform.platform_metadata %></td>
  </tr>
  <tr>
    <td><b>Geographic Location:</b></td>
    <td colspan="3"><%= @platform.geo_location %></td>
  </tr>
</table>
<br />
<ul class="nav nav-pills nav-background" id="platformTab">
	<li class="active"><a href="#sensors" data-toggle="pill">Sensor List</a></li>
	<li><a href="#processing" data-toggle="pill">Process Sensors</a></li>
  <li><a href="#dataview" data-toggle="pill">View Sensor Data</a></li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="sensors">
		<h3>Associated Sensors List</h3>

    <%= paginate @sensors %>
		<table>
			<tr>
			  <th width="200">Source Field</th>
			  <th width="200">Label</th>
			  <th width="400">Sensor Metadata</th>
        <th width="80"></th>
			</tr>
      <%= render @sensors %>
		</table>
  </div>

  <div class="tab-pane" id="processing">
    <div class="sensor-controls">
     	<%= link_to 'New Process', new_platform_event_path(@platform), class: "btn btn-primary" %>
    </div>
    <h3>Process Event List</h3>
    <br />

    <%= paginate @events, :param_name => "event_page" %>
  	<table>
  		<tr>
        <th width="200">Processed Field</th>
        <th width="200">Raw Data Fields</th>
  			<th width="500">Description</th>
        <th widht="160"></th>
        <th widht="160"></th>
  		</tr>
  		<%= render @events, :locals => { :platform => @platform } %>
  	</table>
  </div>

  <div class="tab-pane" id="dataview">
    <h3>View Both Raw and Processed Sensor Data</h3>
    <%= render :partial => 'highchart', :locals => { nodata: @platform.no_data_value.to_f, raw_data: @raw_data, proc_data: @proc_data } %>
  </div>
</div>

<script type="text/javascript">
  $('#platformTab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });
  <%= raw show_tab_for("platformTab") %>
</script>
